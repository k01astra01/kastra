<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>K-Astra</title>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- ================= HEADER ================= -->
  <header class="header">
    <div class="container nav">
      <h1 class="logo">YourCompany</h1>
      <nav>
        <a href="index.html" data-link>Home</a>
        <a href="about.html" data-link>About</a>
        <a href="programs.html" data-link>Programs</a>
        <a href="contacts.html" data-link>Contact</a>
      </nav>
    </div>
  </header>

  <!-- ================= SPA CONTENT ROOT ================= -->
  <main id="app">
    <!-- Home content loads here -->
    <section class="hero">
      <div class="container">
        <h2>Smart Digital Solutions for Growing Businesses</h2>
        <p>
          We provide modern software, automation, and AI-driven systems
          to help businesses scale efficiently.
        </p>
        <a href="#" class="btn">Get Started</a>
      </div>
    </section>
  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="footer">
    <div class="container">
      <p>Â© 2026 YourCompany. All Rights Reserved.</p>
    </div>
  </footer>

  <!-- =====================================================
       1ï¸âƒ£ ELEVENLABS WIDGET SCRIPT (LOAD ONCE ONLY)
       ===================================================== -->
  <script src="https://elevenlabs.io/convai-widget/index.js"></script>

  <!-- =====================================================
       2ï¸âƒ£ ELEVENLABS NAVIGATION TOOL + SPA ROUTER
       ===================================================== -->
  <script>
    console.log("ðŸ”¹ Initializing ElevenLabs SPA navigation");

    /* ---------- SPA PAGE LOADER ---------- */
    async function loadPage(path) {
      try {
        const response = await fetch(path);
        const html = await response.text();

        const temp = document.createElement("div");
        temp.innerHTML = html;

        const newContent = temp.querySelector("main");
        if (!newContent) throw new Error("No <main> found");

        document.getElementById("app").innerHTML = newContent.innerHTML;
        history.pushState({}, "", path);

        console.log("âœ… SPA loaded:", path);
      } catch (err) {
        console.error("âŒ SPA load failed", err);
        window.location.href = path; // fallback
      }
    }

    /* ---------- NAV MENU CLICK ---------- */
    document.addEventListener("click", (e) => {
      const link = e.target.closest("a[data-link]");
      if (!link) return;

      e.preventDefault();
      loadPage(link.getAttribute("href"));
    });

    /* ---------- ELEVENLABS TOOL ---------- */
    document.addEventListener("DOMContentLoaded", () => {
      const widget = document.querySelector("elevenlabs-convai");

      if (!widget) {
        console.error("âŒ ElevenLabs widget not found");
        return;
      }

      widget.addEventListener("elevenlabs-convai:call", (event) => {
        event.detail.config.clientTools = {
          navigate: ({ url }) => {
            console.log("âž¡ï¸ navigate tool called:", url);

            if (!url) return "No URL provided";

            if (url.startsWith("http")) {
              window.open(url, "_blank", "noopener,noreferrer");
              return `Opened ${url}`;
            }

            loadPage(url);
            return `Navigating to ${url}`;
          }
        };
      });

      console.log("âœ… ElevenLabs navigation tool registered");
    });

    /* ---------- BACK / FORWARD ---------- */
    window.addEventListener("popstate", () => {
      loadPage(location.pathname);
    });
  </script>

  <!-- =====================================================
       3ï¸âƒ£ ELEVENLABS WIDGET (ONLY ONE INSTANCE)
       ===================================================== -->
  <elevenlabs-convai
    agent-id="agent_7901kekr51p2fxfr3j3gjh38wvj2">
  </elevenlabs-convai>

</body>
</html>
